(()=>{"use strict";var e={877:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))},r=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.StocksRepositoryRequest=void 0;const s=r(o(167)),a=o(978);t.StocksRepositoryRequest=class{constructor(){this.tokenAPI="EZ3IPW2YUAGT6T0O"}findByRecentQuotes(e){return n(this,void 0,void 0,(function*(){try{return s.default.get(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${e}&apikey=${this.tokenAPI}`,{}).then((e=>e)).catch((e=>e))}catch(e){throw new a.AppError(`Message error: ${e}`)}}))}findByHistoricPrices(e){return n(this,void 0,void 0,(function*(){try{return s.default.get(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${e}&apikey=${this.tokenAPI}`,{}).then((e=>e)).catch((e=>e))}catch(e){throw new a.AppError(`Message error: ${e}`)}}))}compareStocks(e){return n(this,void 0,void 0,(function*(){try{let t=[];for(let o in e)yield s.default.get(`https://www.alphavantage.co/query?function=GLOBAL_QUOTE&symbol=${e[o]}&apikey=${this.tokenAPI}`,{}).then((e=>{t.push(e)})).catch((e=>e));return t}catch(e){return e}}))}findByProjectGains(e){return n(this,void 0,void 0,(function*(){try{return s.default.get(`https://www.alphavantage.co/query?function=TIME_SERIES_DAILY&symbol=${e}&apikey=${this.tokenAPI}`,{}).then((e=>e)).catch((e=>e))}catch(e){throw new a.AppError(`Message error: ${e}`)}}))}}},22:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListCompareStocksController=void 0;const r=o(896),s=o(419);t.ListCompareStocksController=class{handle(e,t){return n(this,void 0,void 0,(function*(){const{stock_name:o}=e.params,{stocks:n}=e.body,a=r.container.resolve(s.ListCompareStocksUseCase),i=yield a.execute({stock_name:o,stocks:n});return t.json(i)}))}}},419:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListCompareStocksUseCase=void 0,o(236);const i=o(896),c=o(978),u=o(42),l=o(689);let f=class{constructor(e){this.stocksRepositoryRequest=e,this.messageError="Thank you for using Alpha Vantage! Our standard API call frequency is 5 calls per minute and 500 calls per day. Please visit https://www.alphavantage.co/premium/ if you would like to target a higher API call frequency."}execute({stock_name:e,stocks:t}){return a(this,void 0,void 0,(function*(){t.unshift(e);const o=yield this.stocksRepositoryRequest.compareStocks(t),n={},r=[];let s={};for(let e=0;e<o.length;e++){const n=o[e].data["Global Quote"];if(o[e].data.Note)throw new c.AppError(this.messageError);{if(void 0===n["01. symbol"])throw new c.AppError(`Name Invalid: ${t[e]}`);let o=n["01. symbol"],a=(0,l.convertAndParseFloat)(n["05. price"]),i=n["07. latest trading day"],f=(0,u.convertDateToUTC)(i);null!=o&&(s={name:o,lastPrice:a,pricedAt:f},r.push(s))}}if(r.length>=1)return Object.assign(n,{lastPrice:r}),n}))}};f=n([(0,i.injectable)(),s(0,(0,i.inject)("StocksRepositoryRequest")),r("design:paramtypes",[Object])],f),t.ListCompareStocksUseCase=f},192:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListHistoricPricesController=void 0;const r=o(896),s=o(484);t.ListHistoricPricesController=class{handle(e,t){return n(this,void 0,void 0,(function*(){const{stock_name:o}=e.params,{from:n,to:a}=e.query,i=r.container.resolve(s.ListHistoricPricesUseCase),c=yield i.execute({stock_name:o,from:n,to:a});return t.json(c)}))}}},484:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListHistoricPricesUseCase=void 0,o(236);const i=o(896),c=o(978),u=o(42),l=o(689);let f=class{constructor(e){this.stocksRepositoryRequest=e,this.messageError="Thank you for using Alpha Vantage! Our standard API call frequency is 5 calls per minute and 500 calls per day. Please visit https://www.alphavantage.co/premium/ if you would like to target a higher API call frequency."}execute({stock_name:e,from:t,to:o}){return a(this,void 0,void 0,(function*(){const n=yield this.stocksRepositoryRequest.findByHistoricPrices(e,t,o),r={},s=[];let a={};if(n.data["Error Message"])throw new c.AppError("Name invalid");if(n.data.Note)throw new c.AppError(this.messageError);const i=n.data["Meta Data"],f=n.data["Time Series (Daily)"],d=Object.keys(f);let p=i["2. Symbol"],h=(0,u.convertDate)(t),v=(0,u.convertDate)(o);for(let e in d){let n=(0,u.convertDate)(d[e]);if(!f[t]||!f[o])throw new c.AppError("Date invalid");n>=h&&n<=v&&(a={opening:(0,l.convertAndParseFloat)(f[d[e]]["1. open"]),low:(0,l.convertAndParseFloat)(f[d[e]]["2. high"]),high:(0,l.convertAndParseFloat)(f[d[e]]["3. low"]),closing:(0,l.convertAndParseFloat)(f[d[e]]["4. close"]),pricedAt:(0,u.convertDateToUTC)(d[e])},s.push(a))}return Object.assign(r,{name:p,prices:s.reverse()}),r}))}};f=n([(0,i.injectable)(),s(0,(0,i.inject)("StocksRepositoryRequest")),r("design:paramtypes",[Object])],f),t.ListHistoricPricesUseCase=f},964:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListProjectGainsController=void 0;const r=o(896),s=o(147);t.ListProjectGainsController=class{handle(e,t){return n(this,void 0,void 0,(function*(){const{stock_name:o}=e.params,{purchasedAmount:n,purchasedAt:a}=e.query,i=r.container.resolve(s.ListProjectGainsUseCase),c=yield i.execute({stock_name:o,purchasedAmount:n,purchasedAt:a});return t.json(c)}))}}},147:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListProjectGainsUseCase=void 0,o(236);const i=o(896),c=o(978),u=o(689);let l=class{constructor(e){this.stocksRepositoryRequest=e,this.messageError="Thank you for using Alpha Vantage! Our standard API call frequency is 5 calls per minute and 500 calls per day. Please visit https://www.alphavantage.co/premium/ if you would like to target a higher API call frequency.",this.messageInvalidApi="Invalid API call. Please retry or visit the documentation (https://www.alphavantage.co/documentation/) for TIME_SERIES_DAILY."}execute({stock_name:e,purchasedAmount:t,purchasedAt:o}){return a(this,void 0,void 0,(function*(){const n=yield this.stocksRepositoryRequest.findByProjectGains(e,t,o);if(n.data["Error Message"])throw new c.AppError("Name invalid");const r={},s=n.data["Meta Data"],a=n.data["Time Series (Daily)"];if(n.data.Note)throw new c.AppError(this.messageError);if(null==a[o])throw new c.AppError("Date invalid");if(n.data["Error Message"])throw new c.AppError(this.messageInvalidApi);let i=s["2. Symbol"],l=Number(t),f=(0,u.convertAndParseFloat)(a[o]["4. close"]),d=s["3. Last Refreshed"],p=(0,u.convertAndParseFloat)(a[d]["4. close"]),h=p*l-f*l;return Object.assign(r,{name:i,purchasedAmount:l,purchasedAt:o,priceAtDate:f,lastPrice:p,capitalGains:h}),r}))}};l=n([(0,i.injectable)(),s(0,(0,i.inject)("StocksRepositoryRequest")),r("design:paramtypes",[Object])],l),t.ListProjectGainsUseCase=l},854:function(e,t,o){var n=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListRecentQuotesController=void 0;const r=o(896),s=o(762);t.ListRecentQuotesController=class{handle(e,t){return n(this,void 0,void 0,(function*(){const{stock_name:o}=e.params,n=r.container.resolve(s.ListRecentQuotesUseCase),a=yield n.execute({stock_name:o});return t.json(a)}))}}},762:function(e,t,o){var n=this&&this.__decorate||function(e,t,o,n){var r,s=arguments.length,a=s<3?t:null===n?n=Object.getOwnPropertyDescriptor(t,o):n;if("object"==typeof Reflect&&"function"==typeof Reflect.decorate)a=Reflect.decorate(e,t,o,n);else for(var i=e.length-1;i>=0;i--)(r=e[i])&&(a=(s<3?r(a):s>3?r(t,o,a):r(t,o))||a);return s>3&&a&&Object.defineProperty(t,o,a),a},r=this&&this.__metadata||function(e,t){if("object"==typeof Reflect&&"function"==typeof Reflect.metadata)return Reflect.metadata(e,t)},s=this&&this.__param||function(e,t){return function(o,n){t(o,n,e)}},a=this&&this.__awaiter||function(e,t,o,n){return new(o||(o=Promise))((function(r,s){function a(e){try{c(n.next(e))}catch(e){s(e)}}function i(e){try{c(n.throw(e))}catch(e){s(e)}}function c(e){var t;e.done?r(e.value):(t=e.value,t instanceof o?t:new o((function(e){e(t)}))).then(a,i)}c((n=n.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.ListRecentQuotesUseCase=void 0,o(236);const i=o(896),c=o(978),u=o(42),l=o(689);let f=class{constructor(e){this.stocksRepositoryRequest=e,this.messageError="Thank you for using Alpha Vantage! Our standard API call frequency is 5 calls per minute and 500 calls per day. Please visit https://www.alphavantage.co/premium/ if you would like to target a higher API call frequency."}execute({stock_name:e}){return a(this,void 0,void 0,(function*(){const t=yield this.stocksRepositoryRequest.findByRecentQuotes(e),o={},n=t.data["Global Quote"];if(t.data.Note)throw new c.AppError(this.messageError);let r=n["01. symbol"],s=(0,l.convertAndParseFloat)(n["05. price"]),a=(0,u.convertDateToUTC)(n["07. latest trading day"]);if(null!=r)return Object.assign(o,{name:r,lastPrice:s,pricedAt:a}),o;if(n)throw new c.AppError("Stock name invalid")}))}};f=n([(0,i.injectable)(),s(0,(0,i.inject)("StocksRepositoryRequest")),r("design:paramtypes",[Object])],f),t.ListRecentQuotesUseCase=f},594:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0});const n=o(896),r=o(877);n.container.registerSingleton("StocksRepositoryRequest",r.StocksRepositoryRequest)},978:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.AppError=void 0,t.AppError=class{constructor(e,t=400){this.message=e,this.statusCode=t}}},869:function(e,t,o){var n=this&&this.__importDefault||function(e){return e&&e.__esModule?e:{default:e}};Object.defineProperty(t,"__esModule",{value:!0}),t.app=void 0,o(236);const r=n(o(860));o(383),o(594);const s=o(978),a=o(934),i=(0,r.default)();t.app=i,i.use(r.default.json()),i.use(a.router),i.use(((e,t,o,n)=>e instanceof s.AppError?o.status(e.statusCode).json({message:e.message}):o.status(500).json({status:"error",message:`Internal server error: ${e.message}`})))},934:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.router=void 0;const n=o(860),r=o(160),s=(0,n.Router)();t.router=s,s.use("/stocks",r.stocksRouter)},160:(e,t,o)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.stocksRouter=void 0;const n=o(860),r=o(22),s=o(192),a=o(964),i=o(854),c=(0,n.Router)();t.stocksRouter=c;const u=new i.ListRecentQuotesController,l=new s.ListHistoricPricesController,f=new r.ListCompareStocksController,d=new a.ListProjectGainsController;c.get("/:stock_name/quote",u.handle),c.get("/:stock_name/history",l.handle),c.get("/:stock_name/compare",f.handle),c.get("/:stock_name/gains",d.handle)},42:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertDate=t.convertDateToUTC=void 0,t.convertDate=e=>Date.parse(e),t.convertDateToUTC=e=>{let t=Date.parse(e),o=new Date(t),n=o.getFullYear().toString()+"-";return n+=(o.getMonth()+1).toString().padStart(2,"0")+"-",n+=(o.getDate()+1).toString().padStart(2,"0")+"T",n+=o.getHours().toString().padStart(2,"0")+":",n+=o.getMinutes().toString().padStart(2,"0")+":",n+=o.getSeconds().toString().padStart(2,"0")+"Z",n}},689:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.convertAndParseFloat=void 0,t.convertAndParseFloat=e=>Number(parseFloat(e).toFixed(2))},167:e=>{e.exports=require("axios")},860:e=>{e.exports=require("express")},383:e=>{e.exports=require("express-async-errors")},236:e=>{e.exports=require("reflect-metadata")},896:e=>{e.exports=require("tsyringe")}},t={};(function o(n){var r=t[n];if(void 0!==r)return r.exports;var s=t[n]={exports:{}};return e[n].call(s.exports,s,s.exports,o),s.exports})(869).app.listen(3333,(()=>console.log("Server On")))})();